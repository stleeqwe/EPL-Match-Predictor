<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì‹œë®¬ë ˆì´ì…˜ ê°€ì¤‘ì¹˜ í†µí•© í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #1a1a2e;
            color: #eee;
        }
        h1 {
            color: #00d9ff;
            border-bottom: 2px solid #00d9ff;
            padding-bottom: 10px;
        }
        h2 {
            color: #ff6b6b;
            margin-top: 30px;
        }
        .test-section {
            background: #16213e;
            border: 1px solid #0f3460;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        .success {
            background: #28a745;
            border-left: 4px solid #155724;
        }
        .error {
            background: #dc3545;
            border-left: 4px solid #721c24;
        }
        .info {
            background: #17a2b8;
            border-left: 4px solid #0c5460;
        }
        button {
            background: #00d9ff;
            color: #1a1a2e;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: bold;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #00b8d9;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #0f3460;
        }
        th {
            background: #0f3460;
            color: #00d9ff;
        }
        .highlight {
            background: #ffc107;
            color: #000;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª ì‹œë®¬ë ˆì´ì…˜ ê°€ì¤‘ì¹˜ í†µí•© í…ŒìŠ¤íŠ¸</h1>

    <div class="test-section">
        <h2>ğŸ“‹ í…ŒìŠ¤íŠ¸ ê°œìš”</h2>
        <p>ì´ í˜ì´ì§€ëŠ” TeamAnalyticsì—ì„œ ì„¤ì •í•œ ê°€ì¤‘ì¹˜ê°€ MatchSimulator ì‹œë®¬ë ˆì´ì…˜ì— ì˜¬ë°”ë¥´ê²Œ ë°˜ì˜ë˜ëŠ”ì§€ ê²€ì¦í•©ë‹ˆë‹¤.</p>
        <ul>
            <li>âœ… localStorage ë°ì´í„° ì €ì¥/ë¡œë“œ í…ŒìŠ¤íŠ¸</li>
            <li>âœ… ê°€ì¤‘ì¹˜ ê³„ì‚° ë¡œì§ ê²€ì¦</li>
            <li>âœ… ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ ì°¨ì´ í™•ì¸</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>ğŸ”§ 1ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë°ì´í„° ì„¤ì •</h2>
        <button onclick="setupTestData()">í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±</button>
        <button onclick="clearTestData()">ë°ì´í„° ì´ˆê¸°í™”</button>
        <div id="setup-result"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ“Š 2ë‹¨ê³„: ë°ì´í„° ë¡œë“œ ê²€ì¦</h2>
        <button onclick="testDataLoad()">ë°ì´í„° ë¡œë“œ í…ŒìŠ¤íŠ¸</button>
        <div id="load-result"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ§® 3ë‹¨ê³„: ê°€ì¤‘ì¹˜ ê³„ì‚° ê²€ì¦</h2>
        <button onclick="testWeightCalculation()">ê°€ì¤‘ì¹˜ ê³„ì‚° í…ŒìŠ¤íŠ¸</button>
        <div id="calculation-result"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ¯ 4ë‹¨ê³„: ì‹œë®¬ë ˆì´ì…˜ ë¹„êµ</h2>
        <button onclick="testSimulationDifference()">ì‹œë®¬ë ˆì´ì…˜ ë¹„êµ í…ŒìŠ¤íŠ¸</button>
        <div id="simulation-result"></div>
    </div>

    <script>
        // í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
        function setupTestData() {
            const resultDiv = document.getElementById('setup-result');
            resultDiv.innerHTML = '<div class="info">í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± ì¤‘...</div>';

            try {
                // íŒ€ A: ì„ ìˆ˜í‰ê°€ ìš°ìˆ˜ (90), íŒ€ì „ë ¥ í‰ê·  (70)
                const teamA = {
                    overallScore: 84, // ê°€ì¤‘ì¹˜ 50-50 ê¸°ì¤€
                    playerScore: 90,
                    strengthScore: 70,
                    playerWeight: 50,
                    strengthWeight: 50,
                    timestamp: new Date().toISOString()
                };

                // íŒ€ B: ì„ ìˆ˜í‰ê°€ í‰ê·  (70), íŒ€ì „ë ¥ ìš°ìˆ˜ (90)
                const teamB = {
                    overallScore: 80, // ê°€ì¤‘ì¹˜ 50-50 ê¸°ì¤€
                    playerScore: 70,
                    strengthScore: 90,
                    playerWeight: 50,
                    strengthWeight: 50,
                    timestamp: new Date().toISOString()
                };

                localStorage.setItem('team_overall_score_TestTeamA', JSON.stringify(teamA));
                localStorage.setItem('team_overall_score_TestTeamB', JSON.stringify(teamB));

                resultDiv.innerHTML = `
                    <div class="success">âœ… í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„± ì™„ë£Œ</div>
                    <table>
                        <tr>
                            <th>íŒ€</th>
                            <th>ì„ ìˆ˜í‰ê°€</th>
                            <th>íŒ€ì „ë ¥</th>
                            <th>ì¢…í•©ì ìˆ˜</th>
                            <th>ê°€ì¤‘ì¹˜ (ì„ ìˆ˜/íŒ€)</th>
                        </tr>
                        <tr>
                            <td>TestTeamA</td>
                            <td class="highlight">${teamA.playerScore}</td>
                            <td>${teamA.strengthScore}</td>
                            <td>${teamA.overallScore}</td>
                            <td>${teamA.playerWeight}% / ${teamA.strengthWeight}%</td>
                        </tr>
                        <tr>
                            <td>TestTeamB</td>
                            <td>${teamB.playerScore}</td>
                            <td class="highlight">${teamB.strengthScore}</td>
                            <td>${teamB.overallScore}</td>
                            <td>${teamB.playerWeight}% / ${teamB.strengthWeight}%</td>
                        </tr>
                    </table>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ ì˜¤ë¥˜: ${error.message}</div>`;
            }
        }

        // ë°ì´í„° ì´ˆê¸°í™”
        function clearTestData() {
            localStorage.removeItem('team_overall_score_TestTeamA');
            localStorage.removeItem('team_overall_score_TestTeamB');
            document.getElementById('setup-result').innerHTML = '<div class="info">âœ“ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚­ì œ ì™„ë£Œ</div>';
        }

        // ë°ì´í„° ë¡œë“œ í…ŒìŠ¤íŠ¸
        function testDataLoad() {
            const resultDiv = document.getElementById('load-result');

            try {
                const teamAData = localStorage.getItem('team_overall_score_TestTeamA');
                const teamBData = localStorage.getItem('team_overall_score_TestTeamB');

                if (!teamAData || !teamBData) {
                    resultDiv.innerHTML = '<div class="error">âŒ í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € "í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±"ì„ ì‹¤í–‰í•˜ì„¸ìš”.</div>';
                    return;
                }

                const teamA = JSON.parse(teamAData);
                const teamB = JSON.parse(teamBData);

                resultDiv.innerHTML = `
                    <div class="success">âœ… ë°ì´í„° ë¡œë“œ ì„±ê³µ</div>
                    <pre style="background: #0f3460; padding: 15px; border-radius: 4px; overflow-x: auto;">
TestTeamA:
${JSON.stringify(teamA, null, 2)}

TestTeamB:
${JSON.stringify(teamB, null, 2)}
                    </pre>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ ë¡œë“œ ì‹¤íŒ¨: ${error.message}</div>`;
            }
        }

        // ê°€ì¤‘ì¹˜ ê³„ì‚° ê²€ì¦ (MatchSimulator ë¡œì§ ë³µì œ)
        function testWeightCalculation() {
            const resultDiv = document.getElementById('calculation-result');

            try {
                const teamAData = JSON.parse(localStorage.getItem('team_overall_score_TestTeamA'));
                const teamBData = JSON.parse(localStorage.getItem('team_overall_score_TestTeamB'));

                if (!teamAData || !teamBData) {
                    resultDiv.innerHTML = '<div class="error">âŒ í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
                }

                // ì—¬ëŸ¬ ê°€ì¤‘ì¹˜ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
                const scenarios = [
                    { playerWeight: 50, strengthWeight: 50, name: 'ê· í˜• (50/50)' },
                    { playerWeight: 70, strengthWeight: 30, name: 'ì„ ìˆ˜ ì¤‘ì‹œ (70/30)' },
                    { playerWeight: 30, strengthWeight: 70, name: 'íŒ€ì „ë ¥ ì¤‘ì‹œ (30/70)' },
                    { playerWeight: 100, strengthWeight: 0, name: 'ì„ ìˆ˜ë§Œ (100/0)' },
                    { playerWeight: 0, strengthWeight: 100, name: 'íŒ€ì „ë ¥ë§Œ (0/100)' }
                ];

                let html = '<div class="success">âœ… ê°€ì¤‘ì¹˜ ê³„ì‚° í…ŒìŠ¤íŠ¸ ì™„ë£Œ</div><table><tr><th>ì‹œë‚˜ë¦¬ì˜¤</th><th>íŒ€ A ê³µê²©ë ¥</th><th>íŒ€ B ê³µê²©ë ¥</th><th>ìš°ì„¸íŒ€</th></tr>';

                scenarios.forEach(scenario => {
                    const teamAAttack = (teamAData.playerScore * scenario.playerWeight / 100) +
                                       (teamAData.strengthScore * scenario.strengthWeight / 100);
                    const teamBAttack = (teamBData.playerScore * scenario.playerWeight / 100) +
                                       (teamBData.strengthScore * scenario.strengthWeight / 100);

                    const winner = teamAAttack > teamBAttack ? 'TestTeamA' : 'TestTeamB';
                    const diff = Math.abs(teamAAttack - teamBAttack).toFixed(1);

                    html += `
                        <tr>
                            <td>${scenario.name}</td>
                            <td${teamAAttack > teamBAttack ? ' class="highlight"' : ''}>${teamAAttack.toFixed(1)}</td>
                            <td${teamBAttack > teamAAttack ? ' class="highlight"' : ''}>${teamBAttack.toFixed(1)}</td>
                            <td><strong>${winner}</strong> (${diff}ì  ì°¨ì´)</td>
                        </tr>
                    `;
                });

                html += '</table>';
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ ê³„ì‚° ì‹¤íŒ¨: ${error.message}</div>`;
            }
        }

        // ì‹œë®¬ë ˆì´ì…˜ ë¹„êµ í…ŒìŠ¤íŠ¸ (ê°„ë‹¨í•œ ë²„ì „)
        function testSimulationDifference() {
            const resultDiv = document.getElementById('simulation-result');

            try {
                const teamAData = JSON.parse(localStorage.getItem('team_overall_score_TestTeamA'));
                const teamBData = JSON.parse(localStorage.getItem('team_overall_score_TestTeamB'));

                if (!teamAData || !teamBData) {
                    resultDiv.innerHTML = '<div class="error">âŒ í…ŒìŠ¤íŠ¸ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                    return;
                }

                // ì‹œë®¬ë ˆì´ì…˜ ë¡œì§ (Pro ëª¨ë¸ ë³µì œ)
                function simulatePro(homeScore, awayScore, weights) {
                    const homeAttack = (homeScore.playerScore * weights.playerWeight / 100) +
                                     (homeScore.strengthScore * weights.strengthWeight / 100);
                    const awayAttack = (awayScore.playerScore * weights.playerWeight / 100) +
                                     (awayScore.strengthScore * weights.strengthWeight / 100);
                    const homeBonus = 5;

                    const homeExpectedGoals = Math.max(0, (homeAttack + homeBonus) / 100 * 3);
                    const awayExpectedGoals = Math.max(0, awayAttack / 100 * 3);

                    return {
                        homeGoals: Math.max(0, Math.round(homeExpectedGoals)),
                        awayGoals: Math.max(0, Math.round(awayExpectedGoals)),
                        homeExpectedGoals,
                        awayExpectedGoals
                    };
                }

                // ë‘ ê°€ì§€ ì‹œë‚˜ë¦¬ì˜¤ ë¹„êµ
                const scenario1 = { playerWeight: 70, strengthWeight: 30 }; // ì„ ìˆ˜ ì¤‘ì‹œ
                const scenario2 = { playerWeight: 30, strengthWeight: 70 }; // íŒ€ì „ë ¥ ì¤‘ì‹œ

                // TestTeamA (í™ˆ) vs TestTeamB (ì›ì •)
                const result1 = simulatePro(teamAData, teamBData, scenario1);
                const result2 = simulatePro(teamAData, teamBData, scenario2);

                resultDiv.innerHTML = `
                    <div class="success">âœ… ì‹œë®¬ë ˆì´ì…˜ ë¹„êµ ì™„ë£Œ</div>
                    <table>
                        <tr>
                            <th>ì‹œë‚˜ë¦¬ì˜¤</th>
                            <th>ê°€ì¤‘ì¹˜</th>
                            <th>ì˜ˆìƒ ê³¨</th>
                            <th>ê²°ê³¼</th>
                            <th>ë¹„ê³ </th>
                        </tr>
                        <tr>
                            <td>ì„ ìˆ˜ ì¤‘ì‹œ</td>
                            <td>70% / 30%</td>
                            <td>í™ˆ ${result1.homeExpectedGoals.toFixed(2)} - ì›ì • ${result1.awayExpectedGoals.toFixed(2)}</td>
                            <td class="highlight">${result1.homeGoals} - ${result1.awayGoals}</td>
                            <td>ì„ ìˆ˜í‰ê°€ ë†’ì€ íŒ€A ìœ ë¦¬</td>
                        </tr>
                        <tr>
                            <td>íŒ€ì „ë ¥ ì¤‘ì‹œ</td>
                            <td>30% / 70%</td>
                            <td>í™ˆ ${result2.homeExpectedGoals.toFixed(2)} - ì›ì • ${result2.awayExpectedGoals.toFixed(2)}</td>
                            <td class="highlight">${result2.homeGoals} - ${result2.awayGoals}</td>
                            <td>íŒ€ì „ë ¥ ë†’ì€ íŒ€B ìœ ë¦¬</td>
                        </tr>
                    </table>
                    <div class="info">
                        <strong>ê²€ì¦ ê²°ê³¼:</strong> ê°€ì¤‘ì¹˜ ë³€ê²½ì— ë”°ë¼ ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼ê°€ ë³€ê²½ë¨ì„ í™•ì¸ âœ…
                        <br>
                        <br>
                        <strong>ì˜ˆìƒ ê³¨ ì°¨ì´:</strong><br>
                        â€¢ ì„ ìˆ˜ ì¤‘ì‹œ ì‹œë‚˜ë¦¬ì˜¤: ${Math.abs(result1.homeExpectedGoals - result1.awayExpectedGoals).toFixed(2)}ê³¨<br>
                        â€¢ íŒ€ì „ë ¥ ì¤‘ì‹œ ì‹œë‚˜ë¦¬ì˜¤: ${Math.abs(result2.homeExpectedGoals - result2.awayExpectedGoals).toFixed(2)}ê³¨
                    </div>
                `;
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">âŒ ì‹œë®¬ë ˆì´ì…˜ ì‹¤íŒ¨: ${error.message}</div>`;
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì•ˆë‚´ ë©”ì‹œì§€
        window.onload = function() {
            console.log('ì‹œë®¬ë ˆì´ì…˜ ê°€ì¤‘ì¹˜ í†µí•© í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
        };
    </script>
</body>
</html>
